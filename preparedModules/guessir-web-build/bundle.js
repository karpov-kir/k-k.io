(()=>{"use strict";var e={279:(e,t,n)=>{n.r(t)},607:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),n(279);var o=n(296),s=n(244),a=n(928);!function(){r(this,void 0,void 0,(function(){var e,t,n,r,l,c,u,h,d;return i(this,(function(i){switch(i.label){case 0:if(e="In order to create your own text check the instructions below.",t="Hello!",n="I am a simple tool to turn any English text into a word guessing game.",r=!0,l=!0,!(0,a.hasApiTextParametersInUrl)())return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),console.log("Trying to load API text"),c=(0,a.parseApiTextIdFromUrl)(),[4,(0,a.loadApiText)(c)];case 2:return u=i.sent(),console.log("API text has been loaded",u),e=u.text,t=u.title,r=u.allowShowingText,l=u.allowShowingFirstLetters,n=u.description,[3,4];case 3:return h=i.sent(),console.log("API text has been failed to load",h),console.error(h),e="\n  I could not load the remote text. Please, verify your URL or create a new text.\n",[3,4];case 4:return d=(new o.LexemeBuilder).buildLexemes(e),new s.RenderManager(d,t,n,r,l).init(document.body),[2]}}))}))}()},748:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.LexemeBuilder=void 0;var i=n(487),o=n(421),s=function(){function e(){this.lexemes=new Map,this.lexemesByWordLike=new Map,this.wordLikeCount=0,this.specialCharacterCount=0,this.lastLexemeIndex=-1}return e.prototype.buildLexemes=function(e){for(var t=e.trim(),n="",r="",o=void 0,s=!1,a=0,l=t.length;a<l;a++){var c=t[a],u=i.LexemeNormalizer.normalizeCharacter(c);if(void 0===o&&(o=a),i.LexemeNormalizer.isWordCharacter(u)){var h=void 0===t[a+1]?void 0:i.LexemeNormalizer.normalizeCharacter(t[a+1]),d=void 0===h||!i.LexemeNormalizer.isWordCharacter(h);n+=c,r+=u,s=d,d&&(r=i.LexemeNormalizer.normalizeWord(n,r))}else n=c,r=u,s=!0;s&&(this.processPrimitiveLexeme(n,r,o,a),o=void 0,n="",r="",s=!1)}var p=this.lexemes,m=this.lexemesByWordLike,f=this.wordLikeCount,v=this.specialCharacterCount;return this.lexemes=new Map,this.lexemesByWordLike=new Map,this.wordLikeCount=0,this.specialCharacterCount=0,this.lastLexemeIndex=-1,{lexemes:p,lexemesByWordLike:m,wordLikeCount:f,specialCharacterCount:v}},e.prototype.processPrimitiveLexeme=function(t,n,s,a){var l=this,c={endIndex:a,startIndex:s,original:t,normalized:n,uncontracted:i.LexemeNormalizer.uncontractPrimitiveLexeme(n)},u=r(r({},c),{type:i.LexemeNormalizer.getLexemeType(c)});if(u.uncontracted===u.normalized){var h=this.isLastLexemesMatch(1,(function(e){return" "===e.normalized})),d=e.PUNCTUATION_CHARACTERS.includes(u.normalized),p="\n"===u.normalized;if((h&&d||h&&p)&&this.deleteLastLexemes((function(e){return" "===e.normalized})),this.canAddLexeme(u)){var m=++this.lastLexemeIndex;this.lexemes.set(m,u),u.type===o.LexemeType.SpecialCharacter?this.specialCharacterCount++:(this.wordLikeCount++,i.LexemeNormalizer.getGroupingWords(u.normalized).forEach((function(e){var t=l.lexemesByWordLike.get(e)||new Map;t.set(m,u),l.lexemesByWordLike.set(e,t)})))}}else this.splitToLexemes(u,s,a)},e.prototype.splitToLexemes=function(e,t,n){var r=this,o=e.uncontracted.split(" ");o.forEach((function(s,a){r.processPrimitiveLexeme(e.original,i.LexemeNormalizer.normalizeWord(e.original,s),t,n),a<o.length-1&&r.processPrimitiveLexeme(" "," ",t,n)}))},e.prototype.canAddLexeme=function(e){return this.lexemes.get(this.lastLexemeIndex)?!("\n"===e.normalized&&this.isLastLexemesMatch(2,(function(e){return"\n"===e.normalized}))||" "===e.normalized&&this.isLastLexemesMatch(1,(function(e){return" "===e.normalized}))):e.type===o.LexemeType.Word||e.type===o.LexemeType.Letter},e.prototype.isLastLexemesMatch=function(e,t){for(var n=this.lastLexemeIndex;e>0;){var r=this.lexemes.get(n);if(!r||!t(r))return!1;n--,e--}return!0},e.prototype.deleteLastLexemes=function(e){for(var t=this,n=this.lexemes.get(this.lastLexemeIndex);n&&e(n);)n.type===o.LexemeType.SpecialCharacter?this.specialCharacterCount--:(this.wordLikeCount--,i.LexemeNormalizer.getGroupingWords(n.normalized).forEach((function(e){var n=t.lexemesByWordLike.get(e)||new Map;n.delete(t.lastLexemeIndex),n.size||t.lexemesByWordLike.delete(e)}))),this.lexemes.delete(this.lastLexemeIndex),this.lastLexemeIndex--,n=this.lexemes.get(this.lastLexemeIndex);return!0},e.PUNCTUATION_CHARACTERS=[",",".","!","?",";"],e}();t.LexemeBuilder=s},487:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LexemeNormalizer=void 0;var r=n(421),i=function(){function e(){}return e.normalizeWord=function(t,n){var r=e.NORMALIZED_WORDS_TO_NORMALIZED_WORDS.get(n)||n;return r[0]!==t[0]&&r[0].toUpperCase()===t[0]&&(r=r[0].toUpperCase()+r.substring(1)),r},e.normalizeCharacter=function(t){var n=t.toLowerCase();return e.CHARACTERS_TO_NORMALIZED_CHARACTERS.get(n)||n},e.uncontractPrimitiveLexeme=function(t){return e.NORMALIZED_CONTRACTION_TO_NORMALIZED_NORMAL.get(t)||t},e.isWordCharacter=function(t){if(1!==t.length)throw new Error("Can be used only for characters");return e.isLetter(t)||e.isWordHelpingCharacter(t)},e.isLetter=function(t){return e.LETTER_RE.test(t)},e.isWordHelpingCharacter=function(t){return e.NORMALIZED_CONTRACTION_CHARACTERS.includes(t)||e.NORMALIZED_WORD_SEPARATION_CHARACTERS.includes(t)},e.getLexemeType=function(t){return 1===t.normalized.length?e.isWordHelpingCharacter(t.normalized)?r.LexemeType.WordHelping:e.isLetter(t.normalized)?r.LexemeType.Letter:r.LexemeType.SpecialCharacter:r.LexemeType.Word},e.getGroupingWords=function(e){var t=e.length,n=e.toLowerCase();return"s"===n[t-1]&&"'"===n[t-2]?[n.slice(0,-2),n]:[n]},e.CHARACTERS_TO_NORMALIZED_CHARACTERS=new Map([["—","-"],["’","'"],["`","'"]]),e.NORMALIZED_WORDS_TO_NORMALIZED_WORDS=new Map([["i","I"]]),e.NORMALIZED_CONTRACTION_CHARACTERS=["'"],e.NORMALIZED_WORD_SEPARATION_CHARACTERS=["-"],e.LETTER_RE=/^[A-Za-z]$/,e.NORMALIZED_CONTRACTION_TO_NORMALIZED_NORMAL=new Map([["don't","do not"],["doesn't","does not"],["didn't","did not"],["haven't","have not"],["hadn't","had not"],["shouldn't","should"],["wouldn't","would not"],["couldn't","could not"],["mustn't","must not"],["can't","cannot"],["needn't","need not"],["won't","will not"],["I'm","I am"],["I've","I have"],["I'll","I will"],["she'll","she will"],["he'll","he will"],["we're","we are"],["we've","we have"],["we'll","we will"],["they're","they are"],["they've","they have"],["they'll","they will"]]),e}();t.LexemeNormalizer=i},296:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(748),t),i(n(421),t)},421:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LexemeType=void 0,(n=t.LexemeType||(t.LexemeType={})).Word="w",n.SpecialCharacter="sc",n.Letter="l",n.WordHelping="wh"},521:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PubSub=void 0;var n=function(){function e(){var e=this;this.subscribers=new Set,this.event={subscribe:function(t){return e.subscribe(t)},unsubscribe:function(t){return e.unsubscribe(t)}}}return e.prototype.publish=function(e){this.subscribers.forEach((function(t){return t(e)}))},e.prototype.subscribe=function(e){if(this.subscribers.has(e))throw new Error("Provided subscriber is already subscribed");this.subscribers.add(e)},e.prototype.unsubscribe=function(e){this.subscribers.delete(e)},e}();t.PubSub=n},643:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(521),t)},227:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ControlsRenderer=void 0;var r=n(643),i=n(928),o=function(){function e(e,t){this.guessPubSub=new r.PubSub,this.showFirstLettersPubSub=new r.PubSub,this.showTextPubSub=new r.PubSub,this.isTextShown=!1,this.isFirstLettersShown=!1,this.guessEvent=this.guessPubSub.event,this.showFirstLettersEvent=this.showFirstLettersPubSub.event,this.showTextEvent=this.showTextPubSub.event,this.containerElement=document.createElement("div"),this.containerElement.id="controls-container",this.initElement(e,t)}return e.prototype.getElement=function(){return this.containerElement},e.prototype.initElement=function(e,t){var n,r;this.containerElement.innerHTML='\n      <input id="guess-input" type="text" />\n      <button id="guess-button" type="button">Guess</button>\n      <label>\n        <input type="checkbox" id="show-text-checkbox" /> Show text\n      </label>\n      <label>\n        <input type="checkbox" id="show-first-letters-checkbox"> Show first letters\n      </label>\n    ';var i=this.containerElement.querySelector("#show-text-checkbox"),o=this.containerElement.querySelector("#show-first-letters-checkbox");e||null===(n=i.parentElement)||void 0===n||n.classList.add("hide"),t||null===(r=o.parentElement)||void 0===r||r.classList.add("hide"),this.attachGuessHandler(),this.attachShowFirstLettersHandler(),this.attachShowTextHandler()},e.prototype.attachGuessHandler=function(){var e=this,t=this.containerElement.querySelector("#guess-button"),n=this.containerElement.querySelector("#guess-input"),r=function(){var t=n.value.trim().toLowerCase();t&&e.guessPubSub.publish({word:t,onWordMatch:function(){n.value="",n.focus()}})};t.addEventListener("click",r),(0,i.onEnter)(n,r)},e.prototype.attachShowTextHandler=function(){var e=this,t=this.containerElement.querySelector("#show-text-checkbox"),n=this.containerElement.querySelector("#show-first-letters-checkbox");(0,i.onChangeAndEnter)(t,(function(){e.isFirstLettersShown&&n.click(),e.isTextShown=!e.isTextShown,t.checked=e.isTextShown,e.showTextPubSub.publish(e.isTextShown)}))},e.prototype.attachShowFirstLettersHandler=function(){var e=this,t=this.containerElement.querySelector("#show-text-checkbox"),n=this.containerElement.querySelector("#show-first-letters-checkbox");(0,i.onChangeAndEnter)(n,(function(){e.isTextShown&&t.click(),e.isFirstLettersShown=!e.isFirstLettersShown,n.checked=e.isFirstLettersShown,e.showFirstLettersPubSub.publish(e.isFirstLettersShown)}))},e}();t.ControlsRenderer=o},916:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateTextRenderer=void 0;var r=n(928),i=function(){function e(){this.generatedUrl="",this.copiedAlertElement=document.createElement("div"),this.containerElement=document.createElement("div"),this.containerElement.id="utils-container",this.copiedAlertElement.innerText="(copied)",this.initElement()}return e.prototype.getElement=function(){return this.containerElement},e.prototype.initElement=function(){this.containerElement.innerHTML='\n      <details>\n        <summary>Create a new text</summary>\n        <div>\n          <div class="inline-flex relative">\n            <input id="title-input" type="text" placeholder="Title*">\n            <div class="limit-text">0/0</div>\n          </div>\n        </div>\n        <div>\n          <div class="inline-flex relative">\n            <textarea rows="2" class="w-100" id="description-input" placeholder="Description"></textarea>\n            <div class="limit-text">0/0</div>\n          </div>\n        </div>\n        <div class="flex relative">\n            <textarea rows="5" class="w-100" id="text-input" placeholder="Text*"></textarea>\n            <div class="limit-text">0/0</div>\n        </div>\n        <div class="flex">\n          <label>\n            <input checked type="checkbox" id="allow-showing-first-letters-checkbox">Allow showing first letters\n          </label>\n          <br />\n          <label>\n            <input checked type="checkbox" id="allow-showing-text-checkbox">Allow showing text\n          </label>\n        </div>\n        <div id="generate-url-button-container">\n          <div class="relative">\n            <div id="generate-url-error" class="error hide"></div>\n            <button id="generate-url-button" type="button">Create</button>\n          </div>\n        </div>\n        <div class="hide flex" id="generated-url-container">\n          <button id="copy-generated-url-button" type="button">\n            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">\n              <path d="M18 21H12C11.2044 21 10.4413 20.6839 9.87868 20.1213C9.31607 19.5587 9 18.7956 9 18V12C9 11.2044 9.31607 10.4413 9.87868 9.87868C10.4413 9.31607 11.2044 9 12 9H18C18.7956 9 19.5587 9.31607 20.1213 9.87868C20.6839 10.4413 21 11.2044 21 12V18C21 18.7956 20.6839 19.5587 20.1213 20.1213C19.5587 20.6839 18.7956 21 18 21ZM12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V18C11 18.2652 11.1054 18.5196 11.2929 18.7071C11.4804 18.8946 11.7348 19 12 19H18C18.2652 19 18.5196 18.8946 18.7071 18.7071C18.8946 18.5196 19 18.2652 19 18V12C19 11.7348 18.8946 11.4804 18.7071 11.2929C18.5196 11.1054 18.2652 11 18 11H12Z" fill="#C7C7C7"/>\n              <path d="M9.73 15H5.67C4.96268 14.9974 4.28509 14.7152 3.78494 14.2151C3.28478 13.7149 3.00263 13.0373 3 12.33V5.67C3.00263 4.96268 3.28478 4.28509 3.78494 3.78494C4.28509 3.28478 4.96268 3.00263 5.67 3H12.33C13.0373 3.00263 13.7149 3.28478 14.2151 3.78494C14.7152 4.28509 14.9974 4.96268 15 5.67V9.4H13V5.67C13 5.49231 12.9294 5.32189 12.8038 5.19624C12.6781 5.07059 12.5077 5 12.33 5H5.67C5.49231 5 5.32189 5.07059 5.19624 5.19624C5.07059 5.32189 5 5.49231 5 5.67V12.33C5 12.5077 5.07059 12.6781 5.19624 12.8038C5.32189 12.9294 5.49231 13 5.67 13H9.73V15Z" fill="#C7C7C7"/>\n            </svg>\n          </button>\n          <a href="#" id="generated-url" target="_blank">#</a>\n        </div>\n      </details>\n    ',this.attachInputHandlers(),this.attachGenerateUrlHandler(),this.attachCopyGeneratedUrlHandler()},e.prototype.getElements=function(){return{titleInputElement:this.containerElement.querySelector("#title-input"),descriptionInputElement:this.containerElement.querySelector("#description-input"),textInputElement:this.containerElement.querySelector("#text-input"),allowShowingFirstLettersCheckboxElement:this.containerElement.querySelector("#allow-showing-first-letters-checkbox"),allowShowingTextCheckboxElement:this.containerElement.querySelector("#allow-showing-text-checkbox"),generateUrlButtonElement:this.containerElement.querySelector("#generate-url-button"),errorElement:this.containerElement.querySelector("#generate-url-error"),generatedUrlContainerElement:this.containerElement.querySelector("#generated-url-container"),generatedUrlElement:this.containerElement.querySelector("#generated-url"),copyGeneratedUrlButtonElement:this.containerElement.querySelector("#copy-generated-url-button")}},e.prototype.getValues=function(){var e=this.getElements(),t=e.titleInputElement,n=e.descriptionInputElement,r=e.textInputElement,i=e.allowShowingFirstLettersCheckboxElement,o=e.allowShowingTextCheckboxElement;return{title:t.value.trim(),description:n.value.trim()||void 0,text:r.value.trim(),allowShowingFirstLetters:i.checked,allowShowingText:o.checked}},e.prototype.limitInputsLength=function(){var e=this.getElements(),t=e.titleInputElement,n=e.descriptionInputElement,r=e.textInputElement,i=function(e,t){var n,r=e.value.trim();r.length>t&&(r=r.substring(0,t),e.value=r);var i=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector(".limit-text");i&&(i.innerHTML="".concat(r.length,"/").concat(t))};i(t,500),i(n,4e3),i(r,4e3)},e.prototype.validateForm=function(e){var t=this.getElements(),n=t.titleInputElement,r=t.textInputElement,i=this.getValues(),o=i.title,s=i.text,a=Boolean(o&&s);return e&&e!==n||(o?n.classList.remove("invalid"):n.classList.add("invalid")),e&&e!==r||(s?r.classList.remove("invalid"):r.classList.add("invalid")),a},e.prototype.blockForm=function(e){var t=this.getElements();[t.titleInputElement,t.descriptionInputElement,t.textInputElement,t.allowShowingFirstLettersCheckboxElement,t.allowShowingTextCheckboxElement,t.generateUrlButtonElement].forEach((function(t){t.disabled=e}))},e.prototype.cleanForm=function(){var e=this.getElements(),t=e.titleInputElement,n=e.descriptionInputElement,r=e.textInputElement,i=e.allowShowingFirstLettersCheckboxElement,o=e.allowShowingTextCheckboxElement;[t,n,r].forEach((function(e){e.value=""})),[i,o].forEach((function(e){e.checked=!0}))},e.prototype.attachInputHandlers=function(){var e=this,t=this.getElements(),n=t.titleInputElement,i=t.descriptionInputElement,o=t.textInputElement,s=t.allowShowingFirstLettersCheckboxElement,a=t.allowShowingTextCheckboxElement;this.limitInputsLength(),[n,i,o].forEach((function(t){t.addEventListener("input",(function(t){e.handleInputsChange(t.currentTarget)}))})),[s,a].forEach((function(t){(0,r.onChangeAndEnter)(t,(function(t){e.handleInputsChange(t.currentTarget)}),{toggleChecked:!0})}))},e.prototype.handleInputsChange=function(e){var t=this.getElements(),n=t.errorElement,r=t.generatedUrlContainerElement;n.classList.add("hide"),r.classList.add("hide"),this.removeCopiedAlert(),this.limitInputsLength(),this.validateForm(e)},e.prototype.attachGenerateUrlHandler=function(){var e=this,t=this.getElements(),n=t.generateUrlButtonElement,i=t.errorElement,o=t.generatedUrlContainerElement,s=t.generatedUrlElement;n.addEventListener("click",(function(){e.validateForm()&&(e.blockForm(!0),o.classList.add("hide"),(0,r.createApiText)(e.getValues()).then((function(t){e.cleanForm(),e.generatedUrl=(0,r.generateApiTextUrl)(t),o.classList.remove("hide"),s.innerText=e.generatedUrl,s.href=e.generatedUrl})).catch((function(e){console.error(e),i.classList.remove("hide"),i.innerText=e.message})).finally((function(){e.blockForm(!1)})))}))},e.prototype.removeCopiedAlert=function(){var e=this.getElements().copyGeneratedUrlButtonElement;e.contains(this.copiedAlertElement)&&e.removeChild(this.copiedAlertElement)},e.prototype.attachCopyGeneratedUrlHandler=function(){var e,t=this,n=this.getElements().copyGeneratedUrlButtonElement;n.addEventListener("click",(function(){navigator.clipboard.writeText(t.generatedUrl),n.appendChild(t.copiedAlertElement),e&&clearTimeout(e),e=setTimeout((function(){t.removeCopiedAlert()}),5e3)}))},e}();t.CreateTextRenderer=i},865:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderManager=void 0;var r=n(227),i=n(916),o=n(54),s=n(805),a=function(){function e(e,t,n,a,l){this.guessirContainer=document.createElement("div"),this.guessirContainer.id="guessir",this.textRenderer=new s.TextRenderer(e,t,n),this.controlsRenderer=new r.ControlsRenderer(a,l),this.scoreRenderer=new o.ScoreRenderer(e.wordLikeCount),this.utilsRenderer=new i.CreateTextRenderer}return e.prototype.init=function(e){var t=this;e.appendChild(this.guessirContainer),this.textRenderer.userWordShowEvent.subscribe((function(e){return t.handleUserWordShow(e)})),this.controlsRenderer.guessEvent.subscribe((function(e){return t.handleGuess(e)})),this.controlsRenderer.showTextEvent.subscribe((function(e){return t.handleShowText(e)})),this.controlsRenderer.showFirstLettersEvent.subscribe((function(e){return t.handleShowFirstLetters(e)})),this.guessirContainer.appendChild(this.textRenderer.getElement()),this.guessirContainer.appendChild(this.controlsRenderer.getElement()),this.guessirContainer.appendChild(this.scoreRenderer.getElement()),this.guessirContainer.appendChild(this.utilsRenderer.getElement())},e.prototype.handleUserWordShow=function(e){this.scoreRenderer.addScore(-1)},e.prototype.handleGuess=function(e){var t=e.word,n=e.onWordMatch,r=this.textRenderer.showLexemesByWord(t);r&&n(),this.scoreRenderer.addScore(r)},e.prototype.handleShowText=function(e){this.textRenderer.toggleText(e),e&&this.scoreRenderer.addScore(-7)},e.prototype.handleShowFirstLetters=function(e){this.textRenderer.toggleFirstLetters(e),e&&this.scoreRenderer.addScore(-2)},e}();t.RenderManager=a},54:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScoreRenderer=void 0;var n=function(){function e(e){this.wordLikeCount=0,this.score=0,this.wordLikeCount=e,this.containerElement=document.createElement("div"),this.containerElement.id="score-container",this.initElement()}return e.prototype.getElement=function(){return this.containerElement},e.prototype.addScore=function(e){this.score+=e,this.containerElement.querySelector("#current-score").innerText=this.score.toString()},e.prototype.initElement=function(){this.containerElement.innerHTML='\n      Score:&nbsp;\n      <div id="current-score">'.concat(this.score,'</div>\n      /\n      <div id="total-score">').concat(this.wordLikeCount,"</div>\n    ")},e}();t.ScoreRenderer=n},244:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(865),t)},199:function(e,t,n){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.TextRenderer=void 0;var o=n(296),s=n(643),a=n(197),l=function(){function e(e,t,n){this.title="",this.userWordShowPubSub=new s.PubSub,this.wordRenderers=new Map,this.userWordShowEvent=this.userWordShowPubSub.event,this.lexemesAnalysis=e,this.title=t,this.description=n,this.containerElement=document.createElement("div"),this.containerElement.id="text-container",this.initElement()}return e.prototype.getElement=function(){return this.containerElement},e.prototype.showLexemesByWord=function(e){var t,n,o=this.lexemesAnalysis.lexemesByWordLike.get(e),s=0;if(!o)return s;try{for(var a=r(o),l=a.next();!l.done;l=a.next()){var c=i(l.value,1)[0],u=this.wordRenderers.get(c);if(u){var h=u.isShown;u.show(),h||s++}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return s},e.prototype.toggleText=function(e){this.containerElement.classList.remove("show-text","show-first-letters"),e?this.containerElement.classList.add("show-text"):this.containerElement.classList.remove("show-text")},e.prototype.toggleFirstLetters=function(e){this.containerElement.classList.remove("show-text","show-first-letters"),e?this.containerElement.classList.add("show-first-letters"):this.containerElement.classList.remove("show-first-letters")},e.prototype.initElement=function(){var e,t,n=this;if(this.title){var s=document.createElement("h1");s.innerText=this.title,this.containerElement.appendChild(s)}if(this.description){var l=document.createElement("p");l.innerText=this.description,this.containerElement.appendChild(l)}try{for(var c=r(this.lexemesAnalysis.lexemes),u=c.next();!u.done;u=c.next()){var h=i(u.value,2),d=h[0],p=h[1];if(p.type===o.LexemeType.SpecialCharacter)this.containerElement.append(this.wrapSpecialCharacter(p));else{var m=new a.WordRenderer(p);m.userWordShowEvent.subscribe((function(e){return n.handleUserWordShow(e)})),this.wordRenderers.set(d,m),this.containerElement.appendChild(m.getElement())}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}},e.prototype.wrapSpecialCharacter=function(e){return"\n"===e.normalized?document.createElement("br"):e.normalized},e.prototype.handleUserWordShow=function(e){this.userWordShowPubSub.publish(e)},e}();t.TextRenderer=l},197:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WordRenderer=void 0;var r=n(643),i=function(){function e(e){this.userWordShowPubSub=new r.PubSub,this.isShown=!1,this.userWordShowEvent=this.userWordShowPubSub.event,this.lexeme=e,this.containerElement=document.createElement("button"),this.containerElement.classList.add("lexeme-container"),this.initElement()}return e.prototype.getElement=function(){return this.containerElement},e.prototype.show=function(){var e;this.isShown=!0,null===(e=this.containerElement)||void 0===e||e.classList.add("show")},e.prototype.initElement=function(){this.containerElement.innerHTML='\n      <span class="lexeme">'.concat(this.lexeme.normalized,'</span>\n      <span class="lexeme-first-letter">').concat(this.lexeme.normalized[0],"</span>\n    "),this.attachClickHandler()},e.prototype.attachClickHandler=function(){var e,t=this;null===(e=this.containerElement)||void 0===e||e.addEventListener("click",(function(){t.isShown||(t.show(),t.userWordShowPubSub.publish(t.lexeme))}))},e}();t.WordRenderer=i},805:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(199),t)},608:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.loadApiText=t.parseApiTextIdFromUrl=t.hasApiTextParametersInUrl=t.generateApiTextUrl=t.createApiText=void 0;var o=n(835);t.createApiText=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,fetch((0,o.default)("https://guessir-api.k-k.io","texts"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})];case 1:if(!(t=r.sent()).ok)throw new Error("Request failed");return[4,t.json()];case 2:if(!(n=r.sent()))throw new Error("Could not parse response");return[2,n];case 3:throw r.sent(),new Error("Could not create text");case 4:return[2]}}))}))},t.generateApiTextUrl=function(e){return"".concat(window.location.origin,"?textId=").concat(e.id)},t.hasApiTextParametersInUrl=function(){return!!new URLSearchParams(window.location.search).get("textId")},t.parseApiTextIdFromUrl=function(){var e=new URLSearchParams(window.location.search).get("textId");if(!e)throw new Error("Text ID is empty");return e},t.loadApiText=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return[4,fetch((0,o.default)("https://guessir-api.k-k.io","texts/".concat(e)),{method:"GET"})];case 1:if(!(t=r.sent()).ok)throw new Error("Could not load text");return[4,t.json()];case 2:if(!(n=r.sent()))throw new Error("Could not parse response");return[2,n]}}))}))}},593:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.onChangeAndEnter=t.onEnter=void 0,t.onEnter=function(e,t,n){void 0===n&&(n={}),e.addEventListener("keypress",(function(r){"Enter"!==r.key&&"NumpadEnter"!==r.code||(n.toggleChecked&&(e.checked=!e.checked),t(r))}))},t.onChangeAndEnter=function(e,n,r){void 0===r&&(r={}),e.addEventListener("change",(function(e){n(e)})),(0,t.onEnter)(e,n,r)}},928:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(608),t),i(n(593),t),i(n(398),t)},398:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.loadRemoteText=t.parseRemoteTextParametersFromUrl=t.hasRemoteTextParametersInUrl=t.generateRemoteTextUrl=void 0,t.generateRemoteTextUrl=function(e){var t={sfl:e.allowShowingFirstLetters?1:0,st:e.allowShowingText?1:0,rUrl:e.remoteTextUrl},n=btoa(JSON.stringify(t));return"".concat(window.location.origin,"?text=").concat(encodeURIComponent(n))},t.hasRemoteTextParametersInUrl=function(){return!!new URLSearchParams(window.location.search).get("text")},t.parseRemoteTextParametersFromUrl=function(){var e=new URLSearchParams(window.location.search).get("text");if(!e)throw new Error("Missing parameters in URL");var t=JSON.parse(atob(decodeURIComponent(e)));return{allowShowingFirstLetters:Boolean(t.sfl),allowShowingText:Boolean(t.st),remoteTextUrl:t.rUrl}},t.loadRemoteText=function(e){return n(this,void 0,void 0,(function(){var t,n,i,o,s,a,l,c,u,h;return r(this,(function(r){switch(r.label){case 0:return(t=new Headers).append("Cache-Control","no-cache"),[4,fetch("https://thingproxy.freeboard.io/fetch/".concat(e),{method:"GET",headers:t,mode:"no-cors"})];case 1:return[4,r.sent().blob()];case 2:return[4,r.sent().text()];case 3:if(n=r.sent(),i=/<div class="plaintext\s?">((.|\n)*)<\/div>/gim.exec(n),o=/<title>((.|\n)*)<\/title>/gim.exec(n),s=(null==i?void 0:i[1])||"",a=(null==o?void 0:o[1])||"",l=a.indexOf("-"),c=a.slice(l+2),u=(new DOMParser).parseFromString(s,"text/html"),!(h=(u.documentElement.textContent||"").trim()))throw new Error("Parsed text is empty");return[2,{text:h,title:c}]}}))}))}},835:(e,t,n)=>{function r(e){var t=[];if(0===e.length)return"";if("string"!=typeof e[0])throw new TypeError("Url must be a string. Received "+e[0]);if(e[0].match(/^[^/:]+:\/*$/)&&e.length>1){var n=e.shift();e[0]=n+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var r=0;r<e.length;r++){var i=e[r];if("string"!=typeof i)throw new TypeError("Url must be a string. Received "+i);""!==i&&(r>0&&(i=i.replace(/^[\/]+/,"")),i=r<e.length-1?i.replace(/[\/]+$/,""):i.replace(/[\/]+$/,"/"),t.push(i))}var o=t.join("/"),s=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return s.shift()+(s.length>0?"?":"")+s.join("&")}function i(){return r("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}n.r(t),n.d(t,{default:()=>i})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();